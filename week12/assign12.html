<!DOCTYPE html>
<html lang="en">

<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Assignment 12</title>
   <link rel="stylesheet" type="text/css" href="./stylesheet.css">
</head>

<body>
   <form onsubmit="return false">
      <fieldset>
         <legend><h2>Mileage Calculator</h2></legend>
         <label for="startCity">Start City</label>
         <input type="text" name="startCity" required><br><br>
         <label for="startState">Start State</label>
         <input type="text" name="startState" required><br><br>
         <label for="endCity">End City</label>
         <input type="text" name="endCity" required><br><br>
         <label for="endState">End State</label>
         <input name="endState" required><br><br>
         <button type="reset" id="clear">Clear</button>
         <input type="submit" onclick="ajaxRequest()">
         <table id="distance"></table>
      </fieldset>
   </form>

</body>
<script>
   function ajaxRequest() {

      var getFormData = document.getElementsByTagName("INPUT");
      var url = "/cgi-bin/cs213/mileageAjaxJSON?startCity="
      + getFormData.startCity.value + "&startState=" 
      + getFormData.startState.value + "&endCity="
      + getFormData.endCity.value + "&endState="
      + getFormData.endCity.value;
      //console.log(getFormData.startCity.value);
      //document.getElementById("distance").innerHTML = url;
      
      const xhttp = new XMLHttpRequest();
      xhttp.onload = function () {
         const myObj = JSON.parse(this.responseText);
         console.log(myObj);
         /*var tableString = "<tr><th>Starting Point</th><th>Ending Destination</th><th>Miles</th><th>Mode</th></tr>" 
         + "<tr><td>" + myObj.trip.startcity + ", " + myObj.trip.startstate + "</td><td>" + myObj.trip.endcity + ", " + myObj.trip.endstate + "</td><td>" + myObj.trip.miles + "</td></tr>";*/
         
         document.getElementById("distance").innerHTML = tableString;
      }
      xhttp.open("GET", url, true);
      xhttp.send();
   }
</script>
</html>